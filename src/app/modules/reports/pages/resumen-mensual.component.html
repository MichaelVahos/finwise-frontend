<div class="container mt-4">
  <h2>ðŸ“Š Resumen mensual</h2>

  <form class="row g-3 align-items-center mb-4" (ngSubmit)="cargarResumen()">
    <div class="col-auto">
      <label for="mes" class="form-label">Mes:</label>
      <select id="mes" class="form-select" [(ngModel)]="mes" name="mes">
        <option *ngFor="let m of meses" [value]="m.numero">{{ m.nombre }}</option>
      </select>
    </div>

    <div class="col-auto">
      <label for="anio" class="form-label">AÃ±o:</label>
      <input type="number" class="form-control" id="anio" [(ngModel)]="anio" name="anio" min="2000" max="2100" />
    </div>

    <div class="col-auto mt-4">
      <button class="btn btn-primary" type="submit">Ver resumen</button>
    </div>
  </form>

  <div class="card p-4 shadow-sm rounded mb-4">
    <p><strong>ðŸ’° Ingresos:</strong> {{ totalIngresos | currency:'EUR' }}</p>
    <p><strong>ðŸ“‰ Gastos:</strong> {{ totalGastos | currency:'EUR' }}</p>
    <p><strong>ðŸ“ˆ Balance:</strong> {{ balance | currency:'EUR' }}</p>
  </div>

  <div class="mt-4">
    <canvas baseChart [data]="chartData" [options]="chartOptions" [type]="chartType"></canvas>
  </div>

  <div class="mt-3 d-flex gap-2 flex-wrap">
    <button class="btn btn-outline-danger" (click)="exportarPDF()">ðŸ“„ Exportar PDF</button>
    <button class="btn btn-outline-success" (click)="exportarExcel()">ðŸ“Š Exportar Excel</button>
  </div>

  <div class="mt-5">
    <button class="btn btn-info" (click)="generarResumenIA()" [disabled]="cargandoResumen">
      ðŸ¤– Generar resumen con IA
      <span *ngIf="cargandoResumen" class="spinner-border spinner-border-sm ms-2" role="status" aria-hidden="true"></span>
    </button>

    <div *ngIf="resumenIA" class="mt-4 text-start mx-auto" style="max-width: 800px;">
      <h5>ðŸ“˜ Resumen generado por IA:</h5>
      <p style="white-space: pre-line">{{ resumenIA }}</p>
    </div>
  </div>
</div>
